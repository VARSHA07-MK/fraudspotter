import pandas as pd, numpy as np
import matplotlib.pyplot as plt, seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import classification_report, confusion_matrix
df = pd.read_csv('dataset/PS_20174392719_1491204439457_log.csv')
df.head()
sns.countplot(x='isFraud', data=df)
plt.show()
df = df.drop(['nameOrig', 'nameDest'], axis=1)
df = pd.get_dummies(df, columns=['type'], drop_first=True)

y = df['isFraud']
X = df.drop('isFraud', axis=1)
model = RandomForestClassifier(n_estimators=100, class_weight='balanced')
model.fit(X_train, y_train)
print(confusion_matrix(y_test, y_pred))
print(classification_report(y_test, y_pred))
results = X_test.copy()
results['Actual'] = y_test
results['Predicted'] = y_pred
results.to_csv('fraud_detection_results.csv', index=False)
